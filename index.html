<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>PHP Decode wp-autopost plugin</title>
	<meta name="keywords" content="php decode, hex to string" />
	<style type="text/css" media="screen">
	

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}



body {
  font-family: Helvetica, arial, freesans, clean, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  background-color: #fff;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}


/*html {
  font: 14px/1.5 "Helvetica Neue", Helvetica, Arial, sans-serif;
}*/

@media (min-width: 34em) {
  body {
    font-size: 18px;
  }
}



.form-group {
    margin-bottom: 15px;
}

.form-control {
    display: block;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.42857143;
    color: #555;
    background-color: #fff;
    background-image: none;
    border: 1px solid #ccc;
    border-radius: 4px;
    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
    box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
    -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
    -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
    transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}

.btn {
    display: inline-block;
    padding: 6px 12px;
    margin-bottom: 0;
    font-size: 14px;
    font-weight: normal;
    line-height: 1.42857143;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    -ms-touch-action: manipulation;
    touch-action: manipulation;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    background-image: none;
    border: 1px solid transparent;
    border-radius: 4px;
	color: #fff;
	background-color: #286090;
	border-color: #204d74;

}

.btn-block {
  display: block;
  width: 100%;
}
.btn-group-lg>.btn, .btn-lg {
  padding: 10px 16px;
  font-size: 18px;
  line-height: 1.3333333;
  border-radius: 6px;
}

code,
kbd,
pre,
samp {
    font-family: monospace, monospace;
    font-size: 1em;
}

pre {
    display: block;
    padding: 9.5px;
    margin: 0 0 10px;
    font-size: 13px;
    line-height: 1.42857143;
    color: #333;
    word-break: break-all;
    word-wrap: break-word;
    background-color: #f5f5f5;
    border: 1px solid #ccc;
    border-radius: 4px;
}

pre code {
    padding: 0;
    font-size: inherit;
    color: inherit;
    white-space: pre-wrap;
    background-color: transparent;
    border-radius: 0;
}

.clear{
	clear: both;
}

.github iframe{
	float: left;
}


	</style>

</head>
<body>
	<h1>PHP Decode wp-autopost plugin</h1>

	<p>This tool use to decode php code, special for wp-autopost plugin <a href="javascript:;" target="_blank" >http://wp-autopost.org/</a>, write by javascript. Make more fast than <a href="http://www.unphp.net/" target="_blank" >UnPHP - The Online PHP Decoder</a>, just use local explain.</p>

	<div class="github" style="margin-top:15px; margin-bottom: 15px;">

		<iframe src="https://ghbtns.com/github-btn.html?user=icai&repo=unphp&type=star&count=true" frameborder="0" scrolling="0" width="120px" height="20px"></iframe>
		<iframe src="https://ghbtns.com/github-btn.html?user=icai&repo=unphp&type=watch&count=true&v=2" frameborder="0" scrolling="0" width="120px" height="20px"></iframe>
		<iframe src="https://ghbtns.com/github-btn.html?user=icai&repo=unphp&type=fork&count=true" frameborder="0" scrolling="0" width="120px" height="20px"></iframe>
		<div class="clear"></div>
	</div>


	<div>
	<textarea name=""  rows="5"  id="decode" class="form-control" style="margin: 0px;  width: 100%; height: 152px;-webkit-box-sizing: border-box;    -moz-box-sizing: border-box;    box-sizing: border-box;"  >
<?php 
${"\x47\x4c\x4f\x42\x41L\x53"}["o\x75\x68\x6dz\x79l\x78\x66\x62\x6ai"]="fi\x6ct\x65r\x45\x6cem\x65\x6e\x74";
${"GL\x4f\x42\x41L\x53"}["\x62\x61\x71f\x69\x6de\x6c\x77\x6fw"]="\x73t\x61r\x74\x50i\x6edex";
...
?>		

	</textarea>
	</div>
	<div class="form-group" >
		<span >Escape string: </span>
		<span class="checkbox" >
			<label>
				<input type="checkbox" name="escape" checked value="&quot;">
				&quot;
			</label>
		</span>
		<span class="checkbox">
			<label>
				<input type="checkbox" name="escape" value="'">
				'
			</label>
		</span>
		<span class="checkbox">
			<label>
				<input type="checkbox" name="escape" checked value="\">
				\
			</label>
		</span>
	</div>
	<div class="form-group">
		<span >Explain Code: </span>
		<span class="checkbox" >
			<label>
				<input type="checkbox" name="explain"  >
			</label>
		</span>

	</div>
	<div class="form-group">
		<div class="">
			<span >Use MD5 Dictionary Decoding Code: </span>
			<span class="checkbox" >
				<label>
					<input type="checkbox" name="md5"  >
				</label>
			</span>
		</div>
		<div>
			<textarea name=""  rows="5"  id="md5" class="form-control" style="margin: 0px;  width: 100%; height: 152px;-webkit-box-sizing: border-box;    -moz-box-sizing: border-box;    box-sizing: border-box;" placeholder="split by , or ;">login_url,id</textarea>
		</div>
	</div>
	<div style="margin-top: 15px; margin-bottom: 15px;">
		<button type="button" class="btn btn-block btn-lg">DECODE</button>
	</div>

	<h3>Decoded Output:</h3>

	<pre class="brush: php prettyprint" id="output">
		
	</pre>


	<script>
	function $Q(s){
		return document.querySelector(s)
	};
	function $QA(s){
		return document.querySelectorAll(s)
	};
	function addEvent(el, type, handle){
       	if (el.addEventListener) {
            el.addEventListener(type, handle, false);
        } else if (el.attachEvent) {
            el.attachEvent("on" + type, handle);
        }
	};

	function utf8_encode (argString) {
	    // http://kevin.vanzonneveld.net
	    // +   original by: Webtoolkit.info (http://www.webtoolkit.info/)
	    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	    // +   improved by: sowberry
	    // +    tweaked by: Jack
	    // +   bugfixed by: Onno Marsman
	    // +   improved by: Yves Sucaet
	    // +   bugfixed by: Onno Marsman
	    // +   bugfixed by: Ulrich
	    // +   bugfixed by: Rafal Kukawski
	    // *     example 1: utf8_encode('Kevin van Zonneveld');
	    // *     returns 1: 'Kevin van Zonneveld'

	    if (argString === null || typeof argString === "undefined") {
	        return "";
	    }

	    var string = (argString + ''); // .replace(/\r\n/g, "\n").replace(/\r/g, "\n");
	    var utftext = "",
	        start, end, stringl = 0;

	    start = end = 0;
	    stringl = string.length;
	    for (var n = 0; n < stringl; n++) {
	        var c1 = string.charCodeAt(n);
	        var enc = null;

	        if (c1 < 128) {
	            end++;
	        } else if (c1 > 127 && c1 < 2048) {
	            enc = String.fromCharCode((c1 >> 6) | 192) + String.fromCharCode((c1 & 63) | 128);
	        } else {
	            enc = String.fromCharCode((c1 >> 12) | 224) + String.fromCharCode(((c1 >> 6) & 63) | 128) + String.fromCharCode((c1 & 63) | 128);
	        }
	        if (enc !== null) {
	            if (end > start) {
	                utftext += string.slice(start, end);
	            }
	            utftext += enc;
	            start = end = n + 1;
	        }
	    }

	    if (end > start) {
	        utftext += string.slice(start, stringl);
	    }

	    return utftext;
	}


	function tb_md5 (str) {
	    // http://kevin.vanzonneveld.net
	    // +   original by: Webtoolkit.info (http://www.webtoolkit.info/)
	    // + namespaced by: Michael White (http://getsprink.com)
	    // +    tweaked by: Jack
	    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	    // +      input by: Brett Zamir (http://brett-zamir.me)
	    // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	    // -    depends on: utf8_encode
	    // *     example 1: md5('Kevin van Zonneveld');
	    // *     returns 1: '6e658d4bfcb59cc13f96c14450ac40b9'
	    var xl;

	    var rotateLeft = function (lValue, iShiftBits) {
	        return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));
	    };

	    var addUnsigned = function (lX, lY) {
	        var lX4, lY4, lX8, lY8, lResult;
	        lX8 = (lX & 0x80000000);
	        lY8 = (lY & 0x80000000);
	        lX4 = (lX & 0x40000000);
	        lY4 = (lY & 0x40000000);
	        lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);
	        if (lX4 & lY4) {
	            return (lResult ^ 0x80000000 ^ lX8 ^ lY8);
	        }
	        if (lX4 | lY4) {
	            if (lResult & 0x40000000) {
	                return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);
	            } else {
	                return (lResult ^ 0x40000000 ^ lX8 ^ lY8);
	            }
	        } else {
	            return (lResult ^ lX8 ^ lY8);
	        }
	    };

	    var _F = function (x, y, z) {
	        return (x & y) | ((~x) & z);
	    };
	    var _G = function (x, y, z) {
	        return (x & z) | (y & (~z));
	    };
	    var _H = function (x, y, z) {
	        return (x ^ y ^ z);
	    };
	    var _I = function (x, y, z) {
	        return (y ^ (x | (~z)));
	    };

	    var _FF = function (a, b, c, d, x, s, ac) {
	        a = addUnsigned(a, addUnsigned(addUnsigned(_F(b, c, d), x), ac));
	        return addUnsigned(rotateLeft(a, s), b);
	    };

	    var _GG = function (a, b, c, d, x, s, ac) {
	        a = addUnsigned(a, addUnsigned(addUnsigned(_G(b, c, d), x), ac));
	        return addUnsigned(rotateLeft(a, s), b);
	    };

	    var _HH = function (a, b, c, d, x, s, ac) {
	        a = addUnsigned(a, addUnsigned(addUnsigned(_H(b, c, d), x), ac));
	        return addUnsigned(rotateLeft(a, s), b);
	    };

	    var _II = function (a, b, c, d, x, s, ac) {
	        a = addUnsigned(a, addUnsigned(addUnsigned(_I(b, c, d), x), ac));
	        return addUnsigned(rotateLeft(a, s), b);
	    };

	    var convertToWordArray = function (str) {
	        var lWordCount;
	        var lMessageLength = str.length;
	        var lNumberOfWords_temp1 = lMessageLength + 8;
	        var lNumberOfWords_temp2 = (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;
	        var lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;
	        var lWordArray = new Array(lNumberOfWords - 1);
	        var lBytePosition = 0;
	        var lByteCount = 0;
	        while (lByteCount < lMessageLength) {
	            lWordCount = (lByteCount - (lByteCount % 4)) / 4;
	            lBytePosition = (lByteCount % 4) * 8;
	            lWordArray[lWordCount] = (lWordArray[lWordCount] | (str.charCodeAt(lByteCount) << lBytePosition));
	            lByteCount++;
	        }
	        lWordCount = (lByteCount - (lByteCount % 4)) / 4;
	        lBytePosition = (lByteCount % 4) * 8;
	        lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);
	        lWordArray[lNumberOfWords - 2] = lMessageLength << 3;
	        lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;
	        return lWordArray;
	    };

	    var wordToHex = function (lValue) {
	        var wordToHexValue = "",
	            wordToHexValue_temp = "",
	            lByte, lCount;
	        for (lCount = 0; lCount <= 3; lCount++) {
	            lByte = (lValue >>> (lCount * 8)) & 255;
	            wordToHexValue_temp = "0" + lByte.toString(16);
	            wordToHexValue = wordToHexValue + wordToHexValue_temp.substr(wordToHexValue_temp.length - 2, 2);
	        }
	        return wordToHexValue;
	    };

	    var x = [],
	        k, AA, BB, CC, DD, a, b, c, d, S11 = 7,
	        S12 = 12,
	        S13 = 17,
	        S14 = 22,
	        S21 = 5,
	        S22 = 9,
	        S23 = 14,
	        S24 = 20,
	        S31 = 4,
	        S32 = 11,
	        S33 = 16,
	        S34 = 23,
	        S41 = 6,
	        S42 = 10,
	        S43 = 15,
	        S44 = 21;

	    str = this.utf8_encode(str);
	    x = convertToWordArray(str);
	    a = 0x67452301;
	    b = 0xEFCDAB89;
	    c = 0x98BADCFE;
	    d = 0x10325476;

	    xl = x.length;
	    for (k = 0; k < xl; k += 16) {
	        AA = a;
	        BB = b;
	        CC = c;
	        DD = d;
	        a = _FF(a, b, c, d, x[k + 0], S11, 0xD76AA478);
	        d = _FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756);
	        c = _FF(c, d, a, b, x[k + 2], S13, 0x242070DB);
	        b = _FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);
	        a = _FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF);
	        d = _FF(d, a, b, c, x[k + 5], S12, 0x4787C62A);
	        c = _FF(c, d, a, b, x[k + 6], S13, 0xA8304613);
	        b = _FF(b, c, d, a, x[k + 7], S14, 0xFD469501);
	        a = _FF(a, b, c, d, x[k + 8], S11, 0x698098D8);
	        d = _FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF);
	        c = _FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1);
	        b = _FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);
	        a = _FF(a, b, c, d, x[k + 12], S11, 0x6B901122);
	        d = _FF(d, a, b, c, x[k + 13], S12, 0xFD987193);
	        c = _FF(c, d, a, b, x[k + 14], S13, 0xA679438E);
	        b = _FF(b, c, d, a, x[k + 15], S14, 0x49B40821);
	        a = _GG(a, b, c, d, x[k + 1], S21, 0xF61E2562);
	        d = _GG(d, a, b, c, x[k + 6], S22, 0xC040B340);
	        c = _GG(c, d, a, b, x[k + 11], S23, 0x265E5A51);
	        b = _GG(b, c, d, a, x[k + 0], S24, 0xE9B6C7AA);
	        a = _GG(a, b, c, d, x[k + 5], S21, 0xD62F105D);
	        d = _GG(d, a, b, c, x[k + 10], S22, 0x2441453);
	        c = _GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681);
	        b = _GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);
	        a = _GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6);
	        d = _GG(d, a, b, c, x[k + 14], S22, 0xC33707D6);
	        c = _GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87);
	        b = _GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);
	        a = _GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905);
	        d = _GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8);
	        c = _GG(c, d, a, b, x[k + 7], S23, 0x676F02D9);
	        b = _GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);
	        a = _HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942);
	        d = _HH(d, a, b, c, x[k + 8], S32, 0x8771F681);
	        c = _HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122);
	        b = _HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);
	        a = _HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44);
	        d = _HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9);
	        c = _HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60);
	        b = _HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);
	        a = _HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6);
	        d = _HH(d, a, b, c, x[k + 0], S32, 0xEAA127FA);
	        c = _HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085);
	        b = _HH(b, c, d, a, x[k + 6], S34, 0x4881D05);
	        a = _HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039);
	        d = _HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5);
	        c = _HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8);
	        b = _HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);
	        a = _II(a, b, c, d, x[k + 0], S41, 0xF4292244);
	        d = _II(d, a, b, c, x[k + 7], S42, 0x432AFF97);
	        c = _II(c, d, a, b, x[k + 14], S43, 0xAB9423A7);
	        b = _II(b, c, d, a, x[k + 5], S44, 0xFC93A039);
	        a = _II(a, b, c, d, x[k + 12], S41, 0x655B59C3);
	        d = _II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92);
	        c = _II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D);
	        b = _II(b, c, d, a, x[k + 1], S44, 0x85845DD1);
	        a = _II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F);
	        d = _II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0);
	        c = _II(c, d, a, b, x[k + 6], S43, 0xA3014314);
	        b = _II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);
	        a = _II(a, b, c, d, x[k + 4], S41, 0xF7537E82);
	        d = _II(d, a, b, c, x[k + 11], S42, 0xBD3AF235);
	        c = _II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB);
	        b = _II(b, c, d, a, x[k + 9], S44, 0xEB86D391);
	        a = addUnsigned(a, AA);
	        b = addUnsigned(b, BB);
	        c = addUnsigned(c, CC);
	        d = addUnsigned(d, DD);
	    }

	    var temp = wordToHex(a) + wordToHex(b) + wordToHex(c) + wordToHex(d);

	    return temp.toLowerCase();
	}

	function unique(arr) {
	    var res = [];
	    var json = {};
	    for (var i = 0; i < arr.length; i++) {
	        if (!json[arr[i]]) {
	            res.push(arr[i]);
	            json[arr[i]] = 1;
	        }
	    }
	    return res;
	}



	function hexToString(str, escapes){
		//return str;
		return str.replace(/(?:\\)?\\x([0-9a-f]{2})/ig, function(s, d){
			if(s.slice(0,2) == '\\\\'){
				return s;
			}
			//var match = escapes; // add char code [", \]
			return (~escapes.indexOf(d) ? '\\' : '') + String.fromCharCode(parseInt(d, 16))
		});
	};
	function strEsReg(str){
		return str.replace(/[\@\[\]\{\}\$\s\"]/g, function(s){
			return '\\' + s;
		})

	}
	function explain(str){
		var temp = {};
		var k = {};
		// rule 1
		str = str.replace(/(\$\w+)\s*=\s*\"(\w+)\";/g, function(s,key, value){
			temp[key] = value;
			return s;
		});

		for(var i in temp){
			str = str.replace(new RegExp('\\\$\\\{' + strEsReg(i) + '\\\}', 'g'), function(s){
				var q = '\$' + temp[i];
				k[i] = '**';
				return q;
			});
		}
		for(var i in temp){
				if(k[i] == '**'){
					str = str.replace(new RegExp(strEsReg(i) + '\\s*=\\s*\\"' + strEsReg(temp[i])+ '\\";', 'g'), function(s,key, value){
						return '';
					});
				}
		}
		temp = {}, k = {}; // clear 
		// rule 2
		str = str.replace(/(\$\{\"GLOBALS\"\}\[\"\w+\"\])\s*=\s*\"(\w+)\";/g, function(s,key, value){
			temp[key] = value
			return '';
		});
		for(var i in temp){
			str = str.replace(new RegExp('\\\$\\\{' + strEsReg(i) + '\\\}', 'g'), function(s){
				var q = '\$' + temp[i];
				return q;
			});
		}

		return str;
	}

	function strArr2Md5Map(arr, prefix){
		prefix || (prefix = 'm');
		var map = {};
		for (var i = 0; i < arr.length; i++) {
			map[prefix + tb_md5(arr[i])] = arr[i];
		}
		return map;
	}

	function str2Dict(str){
		var arr = [];
		if(/^(\w+(?:,|;)\s*)+?\w+$/.test(str)){
			arr = str.split(/(?:,|;)\s*/)
		} else {
			arr = str.match(/\w+("\\x49\\x44")?/g); // pitfall
		}
		console.info(arr);
		arr = unique(arr);

		return arr;
	}


	function md5Crack(text, str){
		var prefix = 'm';
		var dict = str2Dict(str);
		console.info(dict, dict.length, dict.indexOf('aTable'));
		dict = strArr2Md5Map(dict, prefix);
		text = text.replace(/\$[a-z0-9]{11}([0-9a-f]{32})[a-z0-9]{10}|(?:"|')([0-9a-f]{32})(?:"|')/ig, function(s, md5, md6){
			//console.info(s, md5, arguments);
			if(dict[prefix + md5]){
				return '$' + dict[prefix + md5];
			} else if(dict[prefix + md6]){
				//console.info(dict[prefix + md6].replace(/"\\x49\\x44"/,""));
				return '"' + dict[prefix + md6].replace(/"\\x49\\x44"/,"") +'"' // clear pitfall
			} else {
				return s;
			}
		})
		return text;
	}

	var button = $Q('button'),
		decode = $Q('#decode'),
		output = $Q('#output'),
		md5Dic = $Q('#md5');
		addEvent(button, 'click', function(){
			var escapes = [].filter.call($QA('[name="escape"]'), function(input){ return input.checked}).map(function(input){
				var str = input.value.charCodeAt().toString(16).toLowerCase();
				return str.length < 2 ? '0'+ str : str;
			}),
			innerText;
			innerText = $Q('[name="explain"]').checked ? explain(hexToString(decode.value, escapes)) : hexToString(decode.value, escapes);
			innerText = $Q('[name="md5"]').checked ? md5Crack(innerText, md5Dic.value) : innerText;

			 output.innerText = innerText;
		});



	</script>

	
</body>
</html>
